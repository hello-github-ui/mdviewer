"use strict";(self.webpackChunkmdviewer=self.webpackChunkmdviewer||[]).push([[5756],{28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>c});var r=t(96540);const s={},i=r.createContext(s);function a(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(i.Provider,{value:n},e.children)}},53492:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>l,frontMatter:()=>a,metadata:()=>r,toc:()=>m});const r=JSON.parse('{"id":"\u8c37\u7c92\u5b66\u9662\u5728\u7ebf\u6559\u80b2\u9879\u76ee/day14/09-\u8bfe\u7a0b\u8bc4\u8bba\u529f\u80fd","title":"09-\u8bfe\u7a0b\u8bc4\u8bba\u529f\u80fd","description":"1\u3001\u6570\u636e\u5e93","source":"@site/docs/\u8c37\u7c92\u5b66\u9662\u5728\u7ebf\u6559\u80b2\u9879\u76ee/day14/09-\u8bfe\u7a0b\u8bc4\u8bba\u529f\u80fd.md","sourceDirName":"\u8c37\u7c92\u5b66\u9662\u5728\u7ebf\u6559\u80b2\u9879\u76ee/day14","slug":"/\u8c37\u7c92\u5b66\u9662\u5728\u7ebf\u6559\u80b2\u9879\u76ee/day14/09-\u8bfe\u7a0b\u8bc4\u8bba\u529f\u80fd","permalink":"/mdviewer/docs/\u8c37\u7c92\u5b66\u9662\u5728\u7ebf\u6559\u80b2\u9879\u76ee/day14/09-\u8bfe\u7a0b\u8bc4\u8bba\u529f\u80fd","draft":false,"unlisted":false,"editUrl":"https://github.com/hello-github-ui/mdviewer/edit/master/docs/\u8c37\u7c92\u5b66\u9662\u5728\u7ebf\u6559\u80b2\u9879\u76ee/day14/09-\u8bfe\u7a0b\u8bc4\u8bba\u529f\u80fd.md","tags":[{"inline":true,"label":"\u5c1a\u7845\u8c37","permalink":"/mdviewer/docs/tags/\u5c1a\u7845\u8c37"}],"version":"current","sidebarPosition":9,"frontMatter":{"id":"09-\u8bfe\u7a0b\u8bc4\u8bba\u529f\u80fd","title":"09-\u8bfe\u7a0b\u8bc4\u8bba\u529f\u80fd","tags":["\u5c1a\u7845\u8c37"]},"sidebar":"tutorialSidebar","previous":{"title":"08-\u6574\u5408\u963f\u91cc\u4e91\u89c6\u9891\u64ad\u653e\u5668","permalink":"/mdviewer/docs/\u8c37\u7c92\u5b66\u9662\u5728\u7ebf\u6559\u80b2\u9879\u76ee/day14/08-\u6574\u5408\u963f\u91cc\u4e91\u89c6\u9891\u64ad\u653e\u5668"},"next":{"title":"10-\u968f\u5802\u7b14\u8bb0","permalink":"/mdviewer/docs/\u8c37\u7c92\u5b66\u9662\u5728\u7ebf\u6559\u80b2\u9879\u76ee/day14/10-\u968f\u5802\u7b14\u8bb0"}}');var s=t(74848),i=t(28453);const a={id:"09-\u8bfe\u7a0b\u8bc4\u8bba\u529f\u80fd",title:"09-\u8bfe\u7a0b\u8bc4\u8bba\u529f\u80fd",tags:["\u5c1a\u7845\u8c37"]},c="\u4e00\u3001\u6570\u636e\u5e93\u8bbe\u8ba1",o={},m=[{value:"1\u3001\u6570\u636e\u5e93",id:"1\u6570\u636e\u5e93",level:2},{value:"<strong>2\u3001\u6570\u636e\u8868</strong>",id:"2\u6570\u636e\u8868",level:2},{value:"1\u3001\u5728service-edu\u6a21\u5757\uff0c\u751f\u6210\u8bfe\u7a0b\u8bc4\u8bba\u4ee3\u7801",id:"1\u5728service-edu\u6a21\u5757\u751f\u6210\u8bfe\u7a0b\u8bc4\u8bba\u4ee3\u7801",level:2},{value:"2\u3001\u5728service-ucenter\u6a21\u5757\uff0c\u521b\u5efa\u63a5\u53e3",id:"2\u5728service-ucenter\u6a21\u5757\u521b\u5efa\u63a5\u53e3",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"\u4e00\u6570\u636e\u5e93\u8bbe\u8ba1",children:"\u4e00\u3001\u6570\u636e\u5e93\u8bbe\u8ba1"})}),"\n",(0,s.jsx)(n.h2,{id:"1\u6570\u636e\u5e93",children:"1\u3001\u6570\u636e\u5e93"}),"\n",(0,s.jsx)(n.p,{children:"edu_comment"}),"\n",(0,s.jsx)(n.h2,{id:"2\u6570\u636e\u8868",children:(0,s.jsx)(n.strong,{children:"2\u3001\u6570\u636e\u8868"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"guli_edu.sql\n"})}),"\n",(0,s.jsx)(n.h1,{id:""}),"\n",(0,s.jsx)(n.h1,{id:"\u4e8c\u521b\u5efa\u8bfe\u7a0b\u8bc4\u8bba\u63a5\u53e3",children:(0,s.jsx)(n.strong,{children:"\u4e8c\u3001\u521b\u5efa\u8bfe\u7a0b\u8bc4\u8bba\u63a5\u53e3"})}),"\n",(0,s.jsx)(n.h2,{id:"1\u5728service-edu\u6a21\u5757\u751f\u6210\u8bfe\u7a0b\u8bc4\u8bba\u4ee3\u7801",children:"1\u3001\u5728service-edu\u6a21\u5757\uff0c\u751f\u6210\u8bfe\u7a0b\u8bc4\u8bba\u4ee3\u7801"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\uff081\uff09\u4f7f\u7528mp\u4ee3\u7801\u751f\u6210\u5668\u751f\u6210"})}),"\n",(0,s.jsx)(n.h2,{id:"2\u5728service-ucenter\u6a21\u5757\u521b\u5efa\u63a5\u53e3",children:"2\u3001\u5728service-ucenter\u6a21\u5757\uff0c\u521b\u5efa\u63a5\u53e3"}),"\n",(0,s.jsx)(n.p,{children:"\uff081\uff09"}),"\n",(0,s.jsx)(n.p,{children:"\u5b9e\u73b0\u7528\u6237id\u83b7\u53d6\u7528\u6237\u4fe1\u606f\uff0c\u8fd4\u56de\u7528\u6237\u4fe1\u606f\u5bf9\u8c61"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'//\u6839\u636etoken\u5b57\u7b26\u4e32\u83b7\u53d6\u7528\u6237\u4fe1\u606f\n@PostMapping("getInfoUc/{id}")\npublic com.atguigu.commonutils.vo.UcenterMember getInfo(@PathVariable String id) {\n        //\u6839\u636e\u7528\u6237id\u83b7\u53d6\u7528\u6237\u4fe1\u606f\n        UcenterMember ucenterMember = memberService.getById(id);\n        com.atguigu.commonutils.vo.UcenterMember memeber = new com.atguigu.commonutils.vo.UcenterMember();\n        BeanUtils.copyProperties(ucenterMember,memeber);\n        return memeber;\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"3\u3001\u521b\u5efa\u8bfe\u7a0b\u8bc4\u8bbacontroller"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\uff081\uff09\u5728service-edu\u6a21\u5757\u521b\u5efaclient\uff0c\u5b9e\u73b0\u5fae\u670d\u52a1\u8c03\u7528"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'@Component\n@FeignClient(name="service-ucenter",fallback = UcenterClientImpl.class)\npublic interface UcenterClient {\n\n    //\u6839\u636e\u7528\u6237id\u83b7\u53d6\u7528\u6237\u4fe1\u606f\n    @GetMapping("/ucenterservice/member/getUcenterPay/{memberId}")\n    public UcenterMemberPay getUcenterPay(@PathVariable("memberId") String memberId);\n}\n\n@Component\npublic class UcenterClientImpl implements UcenterClient {\n    @Override\n    public UcenterMemberPay getUcenterPay(String memberId) {\n        return null;\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h1,{id:"2\u521b\u5efa\u8bc4\u8bba\u5217\u8868\u548c\u6dfb\u52a0\u8bc4\u8bba\u63a5\u53e3",children:"\uff082\uff09\u521b\u5efa\u8bc4\u8bba\u5217\u8868\u548c\u6dfb\u52a0\u8bc4\u8bba\u63a5\u53e3"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'@RestController\n@RequestMapping("/eduservice/comment")\n@CrossOrigin\npublic class CommentFrontController {\n\n    @Autowired\n    private CommentService commentService;\n    @Autowired\n    private UcenterClient ucenterClient;\n\n    //\u6839\u636e\u8bfe\u7a0bid\u67e5\u8be2\u8bc4\u8bba\u5217\u8868\n    @ApiOperation(value = "\u8bc4\u8bba\u5206\u9875\u5217\u8868")\n    @GetMapping("{page}/{limit}")\n    public R index(\n            @ApiParam(name = "page", value = "\u5f53\u524d\u9875\u7801", required = true)\n            @PathVariable Long page,\n\n            @ApiParam(name = "limit", value = "\u6bcf\u9875\u8bb0\u5f55\u6570", required = true)\n            @PathVariable Long limit,\n\n            @ApiParam(name = "courseQuery", value = "\u67e5\u8be2\u5bf9\u8c61", required = false)\n                    String courseId) {\n        Page<Comment> pageParam = new Page<>(page, limit);\n\n        QueryWrapper<Comment> wrapper = new QueryWrapper<>();\n        wrapper.eq("course_id",courseId);\n\n        commentService.page(pageParam,wrapper);\n        List<Comment> commentList = pageParam.getRecords();\n\n        Map<String, Object> map = new HashMap<>();\n        map.put("items", commentList);\n        map.put("current", pageParam.getCurrent());\n        map.put("pages", pageParam.getPages());\n        map.put("size", pageParam.getSize());\n        map.put("total", pageParam.getTotal());\n        map.put("hasNext", pageParam.hasNext());\n        map.put("hasPrevious", pageParam.hasPrevious());\n        return R.ok().data(map);\n    }\n\n    @ApiOperation(value = "\u6dfb\u52a0\u8bc4\u8bba")\n    @PostMapping("auth/save")\n    public R save(@RequestBody Comment comment, HttpServletRequest request) {\n        String memberId = JwtUtils.getMemberIdByJwtToken(request);\n        if(StringUtils.isEmpty(memberId)) {\n            return R.error().code(28004).message("\u8bf7\u767b\u5f55");\n        }\n        comment.setMemberId(memberId);\n\n        UcenterMemberPay ucenterInfo = ucenterClient.getUcenterPay(memberId);\n\n        comment.setNickname(ucenterInfo.getNickname());\n        comment.setAvatar(ucenterInfo.getAvatar());\n\n        commentService.save(comment);\n        return R.ok();\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"-1"}),"\n",(0,s.jsx)(n.h1,{id:"\u4e09\u8bfe\u7a0b\u8bc4\u8bba\u524d\u7aef\u6574\u5408",children:"\u4e09\u3001\u8bfe\u7a0b\u8bc4\u8bba\u524d\u7aef\u6574\u5408"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"1\u3001\u5728api\u521b\u5efacommonedu.js"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"import request from '@/utils/request'\n\nexport default {\n\n  getPageList(page, limit, courseId) {\n    return request({\n      url: `/eduservice/comment/${page}/${limit}`,\n      method: 'get',\n      params: {courseId}\n    })\n  },\n  addComment(comment) {\n    return request({\n      url: `/eduservice/comment/auth/save`,\n      method: 'post',\n      data: comment\n    })\n  }\n}\n"})}),"\n",(0,s.jsx)(n.h1,{id:"2\u5728\u8bfe\u7a0b\u8be6\u60c5\u9875\u9762\u8c03\u7528\u65b9\u6cd5-_idvue",children:"2\u3001\u5728\u8bfe\u7a0b\u8be6\u60c5\u9875\u9762\uff0c\u8c03\u7528\u65b9\u6cd5 _id.vue"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"import comment from '@/api/commonedu'\n    \n<script>\nimport course from '@/api/course'\nimport comment from '@/api/commonedu'\nexport default {\n\n     //\u548c\u9875\u9762\u5f02\u6b65\u5f00\u59cb\u7684\n  asyncData({ params, error }) {\n    return {courseId: params.id}\n    \n  },\n  data() {\n    return {\n      data:{},\n      page:1,\n      limit:4,\n      total:10,\n      comment:{\n        content:'',\n        courseId:''\n      },\n      courseInfo:{},\n      chapterVideoList:[],\n      isbuyCourse:false\n    }\n  },\n  created() {\n    this.initCourseInfo()\n    this.initComment()\n  },\n  methods:{\n    //\u83b7\u53d6\u8bfe\u7a0b\u8be6\u60c5\n    initCourseInfo() {\n      course.getCourseInfo(this.courseId)\n            .then(response => {\n              this.courseInfo=response.data.data.courseFrontInfo\n              this.chapterVideoList=response.data.data.chapterVideoList\n              this.isbuyCourse=response.data.data.isbuyCourse\n            })\n    },\n\n    initComment(){\n       comment.getPageList(this.page, this.limit, this.courseId).then(response => {\n           this.data = response.data.data\n       })\n    },\n    addComment(){\n        this.comment.courseId = this.courseId\n        this.comment.teacherId = this.courseInfo.teacherId\n        comment.addComment(this.comment).then(response => {\n            if(response.data.success){\n                this.comment.content = ''\n                this.initComment()\n            }\n        })\n    },\n    gotoPage(page){\n          comment.getPageList(page, this.limit,this.courseId).then(response => {\n              this.data = response.data.data\n          })\n      }\n  }\n  \n};\n<\/script>\n"})}),"\n",(0,s.jsx)(n.h2,{id:"-2"}),"\n",(0,s.jsx)(n.h1,{id:"3\u5728\u8bfe\u7a0b\u8be6\u60c5\u9875\u9762-_idvue\u663e\u793a\u8bc4\u8bba",children:"3\u3001\u5728\u8bfe\u7a0b\u8be6\u60c5\u9875\u9762 _id.vue\u663e\u793a\u8bc4\u8bba"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'<div class="mt50 commentHtml"><div>\n      <h6 class="c-c-content c-infor-title" id="i-art-comment">\n        <span class="commentTitle">\u8bfe\u7a0b\u8bc4\u8bba</span>\n      </h6>\n      <section class="lh-bj-list pr mt20 replyhtml">\n        <ul>\n          <li class="unBr">\n            <aside class="noter-pic">\n              <img width="50" height="50" class="picImg" src="~/assets/img/avatar-boy.gif">\n              </aside>\n            <div class="of">\n              <section class="n-reply-wrap">\n                <fieldset>\n                  <textarea name="" v-model="comment.content" placeholder="\u8f93\u5165\u60a8\u8981\u8bc4\u8bba\u7684\u6587\u5b57" id="commentContent"></textarea>\n                </fieldset>\n                <p class="of mt5 tar pl10 pr10">\n                  <span class="fl "><tt class="c-red commentContentmeg" style="display: none;"></tt></span>\n                  <input type="button" @click="addComment()" value="\u56de\u590d" class="lh-reply-btn">\n                </p>\n              </section>\n            </div>\n          </li>\n        </ul>\n      </section>\n      <section class="">\n          <section class="question-list lh-bj-list pr">\n            <ul class="pr10">\n              <li v-for="(comment,index) in data.items" v-bind:key="index">\n                  <aside class="noter-pic">\n                    <img width="50" height="50" class="picImg" :src="comment.avatar">\n                    </aside>\n                  <div class="of">\n                    <span class="fl"> \n                    <font class="fsize12 c-blue"> \n                      {{comment.nickname}}</font>\n                    <font class="fsize12 c-999 ml5">\u8bc4\u8bba\uff1a</font></span>\n                  </div>\n                  <div class="noter-txt mt5">\n                    <p>{{comment.content}}</p>\n                  </div>\n                  <div class="of mt5">\n                    <span class="fr"><font class="fsize12 c-999 ml5">{{comment.gmtCreate}}</font></span>\n                  </div>\n                </li>\n              \n              </ul>\n          </section>\n        </section>\n        \n        \x3c!-- \u516c\u5171\u5206\u9875 \u5f00\u59cb --\x3e\n        <div class="paging">\n            \x3c!-- undisable\u8fd9\u4e2aclass\u662f\u5426\u5b58\u5728\uff0c\u53d6\u51b3\u4e8e\u6570\u636e\u5c5e\u6027hasPrevious --\x3e\n            <a\n            :class="{undisable: !data.hasPrevious}"\n            href="#"\n            title="\u9996\u9875"\n            @click.prevent="gotoPage(1)">\u9996</a>\n            <a\n            :class="{undisable: !data.hasPrevious}"\n            href="#"\n            title="\u524d\u4e00\u9875"\n            @click.prevent="gotoPage(data.current-1)">&lt;</a>\n            <a\n            v-for="page in data.pages"\n            :key="page"\n            :class="{current: data.current == page, undisable: data.current == page}"\n            :title="\'\u7b2c\'+page+\'\u9875\'"\n            href="#"\n            @click.prevent="gotoPage(page)">{{ page }}</a>\n            <a\n            :class="{undisable: !data.hasNext}"\n            href="#"\n            title="\u540e\u4e00\u9875"\n            @click.prevent="gotoPage(data.current+1)">&gt;</a>\n            <a\n            :class="{undisable: !data.hasNext}"\n            href="#"\n            title="\u672b\u9875"\n            @click.prevent="gotoPage(data.pages)">\u672b</a>\n            <div class="clear"/>\n        </div>\n        \x3c!-- \u516c\u5171\u5206\u9875 \u7ed3\u675f --\x3e\n      </div>\n    </div>\n'})})]})}function l(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);