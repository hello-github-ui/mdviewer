"use strict";(self.webpackChunkmdviewer=self.webpackChunkmdviewer||[]).push([[1081],{3832:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>a,contentTitle:()=>d,default:()=>l,frontMatter:()=>o,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"\u8c37\u7c92\u5b66\u9662\u5728\u7ebf\u6559\u80b2\u9879\u76ee/day15/05-\u8bfe\u7a0b\u8be6\u60c5\u9875\u9762\u529f\u80fd\u5b8c\u5584","title":"05-\u8bfe\u7a0b\u8be6\u60c5\u9875\u9762\u529f\u80fd\u5b8c\u5584","description":"1\u3001\u5728service_order\u6a21\u5757\u6dfb\u52a0\u63a5\u53e3","source":"@site/docs/\u8c37\u7c92\u5b66\u9662\u5728\u7ebf\u6559\u80b2\u9879\u76ee/day15/05-\u8bfe\u7a0b\u8be6\u60c5\u9875\u9762\u529f\u80fd\u5b8c\u5584.md","sourceDirName":"\u8c37\u7c92\u5b66\u9662\u5728\u7ebf\u6559\u80b2\u9879\u76ee/day15","slug":"/\u8c37\u7c92\u5b66\u9662\u5728\u7ebf\u6559\u80b2\u9879\u76ee/day15/05-\u8bfe\u7a0b\u8be6\u60c5\u9875\u9762\u529f\u80fd\u5b8c\u5584","permalink":"/mdviewer/docs/\u8c37\u7c92\u5b66\u9662\u5728\u7ebf\u6559\u80b2\u9879\u76ee/day15/05-\u8bfe\u7a0b\u8be6\u60c5\u9875\u9762\u529f\u80fd\u5b8c\u5584","draft":false,"unlisted":false,"editUrl":"https://github.com/hello-github-ui/mdviewer/edit/master/docs/\u8c37\u7c92\u5b66\u9662\u5728\u7ebf\u6559\u80b2\u9879\u76ee/day15/05-\u8bfe\u7a0b\u8be6\u60c5\u9875\u9762\u529f\u80fd\u5b8c\u5584.md","tags":[{"inline":true,"label":"\u5c1a\u7845\u8c37","permalink":"/mdviewer/docs/tags/\u5c1a\u7845\u8c37"}],"version":"current","sidebarPosition":5,"frontMatter":{"id":"05-\u8bfe\u7a0b\u8be6\u60c5\u9875\u9762\u529f\u80fd\u5b8c\u5584","title":"05-\u8bfe\u7a0b\u8be6\u60c5\u9875\u9762\u529f\u80fd\u5b8c\u5584","tags":["\u5c1a\u7845\u8c37"]},"sidebar":"tutorialSidebar","previous":{"title":"04-\u8bfe\u7a0b\u652f\u4ed8\u524d\u7aef\u6574\u5408","permalink":"/mdviewer/docs/\u8c37\u7c92\u5b66\u9662\u5728\u7ebf\u6559\u80b2\u9879\u76ee/day15/04-\u8bfe\u7a0b\u652f\u4ed8\u524d\u7aef\u6574\u5408"},"next":{"title":"06-\u968f\u5802\u7b14\u8bb0","permalink":"/mdviewer/docs/\u8c37\u7c92\u5b66\u9662\u5728\u7ebf\u6559\u80b2\u9879\u76ee/day15/06-\u968f\u5802\u7b14\u8bb0"}}');var s=n(74848),i=n(28453);const o={id:"05-\u8bfe\u7a0b\u8be6\u60c5\u9875\u9762\u529f\u80fd\u5b8c\u5584",title:"05-\u8bfe\u7a0b\u8be6\u60c5\u9875\u9762\u529f\u80fd\u5b8c\u5584",tags:["\u5c1a\u7845\u8c37"]},d="\u4e00\u3001\u4fee\u6539\u8bfe\u7a0b\u8be6\u60c5\u63a5\u53e3",a={},c=[{value:"1\u3001\u5728service_order\u6a21\u5757\u6dfb\u52a0\u63a5\u53e3",id:"1\u5728service_order\u6a21\u5757\u6dfb\u52a0\u63a5\u53e3",level:2},{value:"<strong>2\u3001\u8c03\u7528\u65b9\u6cd5\u4fee\u6539</strong>",id:"2\u8c03\u7528\u65b9\u6cd5\u4fee\u6539",level:2}];function u(e){const r={code:"code",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.header,{children:(0,s.jsx)(r.h1,{id:"\u4e00\u4fee\u6539\u8bfe\u7a0b\u8be6\u60c5\u63a5\u53e3",children:"\u4e00\u3001\u4fee\u6539\u8bfe\u7a0b\u8be6\u60c5\u63a5\u53e3"})}),"\n",(0,s.jsx)(r.h2,{id:"1\u5728service_order\u6a21\u5757\u6dfb\u52a0\u63a5\u53e3",children:"1\u3001\u5728service_order\u6a21\u5757\u6dfb\u52a0\u63a5\u53e3"}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"\u6839\u636e\u7528\u6237id\u548c\u8bfe\u7a0bid\u67e5\u8be2\u8ba2\u5355\u4fe1\u606f"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{children:'@GetMapping("isBuyCourse/{memberid}/{id}")\npublic boolean isBuyCourse(@PathVariable String memberid,\n                           @PathVariable String id) {\n    //\u8ba2\u5355\u72b6\u6001\u662f1\u8868\u793a\u652f\u4ed8\u6210\u529f\n    int count = orderService.count(new QueryWrapper<TOrder>().eq("member_id", memberid).eq("course_id", id).eq("status", 1));\n    if(count>0) {\n        return true;\n    } else {\n        return false;\n    }\n}\n'})}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"2\u3001\u5728service_edu\u6a21\u5757\u8bfe\u7a0b\u8be6\u60c5\u63a5\u53e3\u8fdc\u7a0b\u8c03\u7528"})}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"\uff081\uff09\u521b\u5efaOrderClient\u63a5\u53e3"})}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.img,{alt:"img",src:n(64996).A+"",width:"200",height:"60"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{children:'@Component\n@FeignClient(value = "service-order", fallback = OrderFile.class)\npublic interface OrderClient {\n    //\u67e5\u8be2\u8ba2\u5355\u4fe1\u606f\n    @GetMapping("/orderservice/order/isBuyCourse/{memberid}/{id}")\n    public boolean isBuyCourse(@PathVariable("memberid") String memberid, @PathVariable("id") String id);\n}\n'})}),"\n",(0,s.jsx)(r.h2,{id:""}),"\n",(0,s.jsxs)(r.p,{children:["**\uff082\uff09**",(0,s.jsx)(r.strong,{children:"\u5728\u8bfe\u7a0b\u8be6\u60c5\u63a5\u53e3\u8c03\u7528"})]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{children:'//\u6839\u636eid\u67e5\u8be2\u8bfe\u7a0b\u8be6\u60c5\u4fe1\u606f\n@GetMapping("getCourseInfo/{id}")\npublic R getCourseInfo(@PathVariable String id, HttpServletRequest request) {\n    //\u8bfe\u7a0b\u67e5\u8be2\u8bfe\u7a0b\u57fa\u672c\u4fe1\u606f\n    CourseFrontInfo courseFrontInfo = courseService.getFrontCourseInfo(id);\n    //\u67e5\u8be2\u8bfe\u7a0b\u91cc\u9762\u5927\u7eb2\u6570\u636e\n    List<ChapterVo> chapterVideoList = chapterService.getChapterVideoById(id);\n    \n    //\u8fdc\u7a0b\u8c03\u7528\uff0c\u5224\u65ad\u8bfe\u7a0b\u662f\u5426\u88ab\u8d2d\u4e70\n    boolean buyCourse = orderClient.isBuyCourse(JwtUtils.getMemberIdByJwtToken(request), id);\n    \n    return R.ok().data("courseFrontInfo",courseFrontInfo).data("chapterVideoList",chapterVideoList).data("isbuy",buyCourse);\n}\n'})}),"\n",(0,s.jsx)(r.h2,{id:"-1"}),"\n",(0,s.jsx)(r.h1,{id:"\u4e8c\u4fee\u6539\u8bfe\u7a0b\u8be6\u60c5\u9875\u9762",children:"\u4e8c\u3001\u4fee\u6539\u8bfe\u7a0b\u8be6\u60c5\u9875\u9762"}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"1\u3001\u9875\u9762\u5185\u5bb9\u4fee\u6539"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{children:'<section v-if="isbuy || Number(courseInfo.price)===0" class="c-attr-mt">\n              <a href="#" title="\u7acb\u5373\u89c2\u770b" class="comm-btn c-btn-3" >\u7acb\u5373\u89c2\u770b</a>\n</section>\n<section v-else class="c-attr-mt">\n    <a href="#" title="\u7acb\u5373\u8d2d\u4e70" class="comm-btn c-btn-3" @click="createOrder()">\u7acb\u5373\u8d2d\u4e70</a>\n</section>\n'})}),"\n",(0,s.jsx)(r.h2,{id:"2\u8c03\u7528\u65b9\u6cd5\u4fee\u6539",children:(0,s.jsx)(r.strong,{children:"2\u3001\u8c03\u7528\u65b9\u6cd5\u4fee\u6539"})}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{children:"<script>\nimport course from '@/api/course'\nexport default {\n  // asyncData({ params, error }) {\n  //   return course.getCourseInfo(params.id)\n  //     .then(response => {\n  //       return {\n  //         courseInfo: response.data.data.courseFrontInfo,\n  //         chapterVideoList: response.data.data.chapterVideoList,\n  //         isbuy: response.data.data.isbuy,\n  //         courseId:params.id\n  //       }\n  //     })\n  // },\n   //\u548c\u9875\u9762\u5f02\u6b65\u5f00\u59cb\u7684\n  asyncData({ params, error }) {\n    return {courseId: params.id}\n    \n  },\n  data() {\n    return {\n      courseInfo: {},\n          chapterVideoList: [],\n          isbuy: false,\n    }\n  },\n  created() {\n    this.initCourseInfo()\n  },\n  methods:{\n    initCourseInfo() {\n      course.getCourseInfo(this.courseId)\n        .then(response => {\n          this.courseInfo=response.data.data.courseFrontInfo,\n          this.chapterVideoList=response.data.data.chapterVideoList,\n          this.isbuy=response.data.data.isbuy\n        })\n    },\n    createOrder(){\n      course.createOrder(this.courseId).then(response => {\n        if(response.data.success){\n            this.$router.push({ path: '/order/'+ response.data.data.orderId })\n        }\n      })\n    }\n  }\n};\n<\/script>\n"})})]})}function l(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},28453:(e,r,n)=>{n.d(r,{R:()=>o,x:()=>d});var t=n(96540);const s={},i=t.createContext(s);function o(e){const r=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function d(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(i.Provider,{value:r},e.children)}},64996:(e,r,n)=>{n.d(r,{A:()=>t});const t="data:image/png;base64,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"}}]);