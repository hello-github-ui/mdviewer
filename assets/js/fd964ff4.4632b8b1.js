"use strict";(self.webpackChunkmdviewer=self.webpackChunkmdviewer||[]).push([[8376],{28453:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>a});var o=r(96540);const i={},s=o.createContext(i);function t(e){const n=o.useContext(s);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),o.createElement(s.Provider,{value:n},e.children)}},76554:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>d,frontMatter:()=>t,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"\u8c37\u7c92\u5b66\u9662\u5728\u7ebf\u6559\u80b2\u9879\u76ee/day07/02-\u7f16\u8f91\u8bfe\u7a0b\u57fa\u672c\u4fe1\u606f","title":"02-\u7f16\u8f91\u8bfe\u7a0b\u57fa\u672c\u4fe1\u606f","description":"1\u3001\u5b9a\u4e49form\u8868\u5355\u5bf9\u8c61","source":"@site/docs/\u8c37\u7c92\u5b66\u9662\u5728\u7ebf\u6559\u80b2\u9879\u76ee/day07/02-\u7f16\u8f91\u8bfe\u7a0b\u57fa\u672c\u4fe1\u606f.md","sourceDirName":"\u8c37\u7c92\u5b66\u9662\u5728\u7ebf\u6559\u80b2\u9879\u76ee/day07","slug":"/\u8c37\u7c92\u5b66\u9662\u5728\u7ebf\u6559\u80b2\u9879\u76ee/day07/02-\u7f16\u8f91\u8bfe\u7a0b\u57fa\u672c\u4fe1\u606f","permalink":"/mdviewer/docs/\u8c37\u7c92\u5b66\u9662\u5728\u7ebf\u6559\u80b2\u9879\u76ee/day07/02-\u7f16\u8f91\u8bfe\u7a0b\u57fa\u672c\u4fe1\u606f","draft":false,"unlisted":false,"editUrl":"https://github.com/hello-github-ui/mdviewer/edit/master/docs/\u8c37\u7c92\u5b66\u9662\u5728\u7ebf\u6559\u80b2\u9879\u76ee/day07/02-\u7f16\u8f91\u8bfe\u7a0b\u57fa\u672c\u4fe1\u606f.md","tags":[{"inline":true,"label":"\u5c1a\u7845\u8c37","permalink":"/mdviewer/docs/tags/\u5c1a\u7845\u8c37"}],"version":"current","sidebarPosition":2,"frontMatter":{"id":"02-\u7f16\u8f91\u8bfe\u7a0b\u57fa\u672c\u4fe1\u606f","title":"02-\u7f16\u8f91\u8bfe\u7a0b\u57fa\u672c\u4fe1\u606f","tags":["\u5c1a\u7845\u8c37"]},"sidebar":"tutorialSidebar","previous":{"title":"01-\u8bfe\u7a0b\u53d1\u5e03\u8868\u5355-\u6b65\u9aa4\u5bfc\u822a","permalink":"/mdviewer/docs/\u8c37\u7c92\u5b66\u9662\u5728\u7ebf\u6559\u80b2\u9879\u76ee/day07/01-\u8bfe\u7a0b\u53d1\u5e03\u8868\u5355-\u6b65\u9aa4\u5bfc\u822a"},"next":{"title":"03-\u8bfe\u7a0b\u5206\u7c7b\u591a\u7ea7\u8054\u52a8\u7684\u5b9e\u73b0","permalink":"/mdviewer/docs/\u8c37\u7c92\u5b66\u9662\u5728\u7ebf\u6559\u80b2\u9879\u76ee/day07/03-\u8bfe\u7a0b\u5206\u7c7b\u591a\u7ea7\u8054\u52a8\u7684\u5b9e\u73b0"}}');var i=r(74848),s=r(28453);const t={id:"02-\u7f16\u8f91\u8bfe\u7a0b\u57fa\u672c\u4fe1\u606f",title:"02-\u7f16\u8f91\u8bfe\u7a0b\u57fa\u672c\u4fe1\u606f",tags:["\u5c1a\u7845\u8c37"]},a="\u4e00\u3001\u540e\u53f0api",c={},l=[{value:"1\u3001\u5b9a\u4e49form\u8868\u5355\u5bf9\u8c61",id:"1\u5b9a\u4e49form\u8868\u5355\u5bf9\u8c61",level:2},{value:"2\u3001\u4fee\u6539CourseDescription\u4e3b\u952e\u751f\u6210\u7b56\u7565",id:"2\u4fee\u6539coursedescription\u4e3b\u952e\u751f\u6210\u7b56\u7565",level:2},{value:"3\u3001\u5b9a\u4e49\u5e38\u91cf",id:"3\u5b9a\u4e49\u5e38\u91cf",level:2},{value:"4\u3001\u5b9a\u4e49\u63a7\u5236\u5c42\u63a5\u53e3",id:"4\u5b9a\u4e49\u63a7\u5236\u5c42\u63a5\u53e3",level:2},{value:"5\u3001\u5b9a\u4e49\u4e1a\u52a1\u5c42\u65b9\u6cd5",id:"5\u5b9a\u4e49\u4e1a\u52a1\u5c42\u65b9\u6cd5",level:2},{value:"6\u3001Swagger\u6d4b\u8bd5",id:"6swagger\u6d4b\u8bd5",level:2},{value:"1\u3001\u5b9a\u4e49api",id:"1\u5b9a\u4e49api",level:2},{value:"2\u3001\u7ec4\u4ef6\u6a21\u677f",id:"2\u7ec4\u4ef6\u6a21\u677f",level:2},{value:"3\u3001\u7ec4\u4ef6js",id:"3\u7ec4\u4ef6js",level:2}];function u(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"\u4e00\u540e\u53f0api",children:"\u4e00\u3001\u540e\u53f0api"})}),"\n",(0,i.jsx)(n.h2,{id:"1\u5b9a\u4e49form\u8868\u5355\u5bf9\u8c61",children:"1\u3001\u5b9a\u4e49form\u8868\u5355\u5bf9\u8c61"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'CourseInfoForm.java\n\npackage com.guli.edu.form;\n\n@ApiModel(value = "\u8bfe\u7a0b\u57fa\u672c\u4fe1\u606f", description = "\u7f16\u8f91\u8bfe\u7a0b\u57fa\u672c\u4fe1\u606f\u7684\u8868\u5355\u5bf9\u8c61")\n@Data\npublic class CourseInfoForm implements Serializable {\n\n    private static final long serialVersionUID = 1L;\n\n    @ApiModelProperty(value = "\u8bfe\u7a0bID")\n    private String id;\n\n    @ApiModelProperty(value = "\u8bfe\u7a0b\u8bb2\u5e08ID")\n    private String teacherId;\n\n    @ApiModelProperty(value = "\u8bfe\u7a0b\u4e13\u4e1aID")\n    private String subjectId;\n\n    @ApiModelProperty(value = "\u8bfe\u7a0b\u6807\u9898")\n    private String title;\n\n    @ApiModelProperty(value = "\u8bfe\u7a0b\u9500\u552e\u4ef7\u683c\uff0c\u8bbe\u7f6e\u4e3a0\u5219\u53ef\u514d\u8d39\u89c2\u770b")\n    private BigDecimal price;\n\n    @ApiModelProperty(value = "\u603b\u8bfe\u65f6")\n    private Integer lessonNum;\n\n    @ApiModelProperty(value = "\u8bfe\u7a0b\u5c01\u9762\u56fe\u7247\u8def\u5f84")\n    private String cover;\n\n    @ApiModelProperty(value = "\u8bfe\u7a0b\u7b80\u4ecb")\n    private String description;\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"2\u4fee\u6539coursedescription\u4e3b\u952e\u751f\u6210\u7b56\u7565",children:"2\u3001\u4fee\u6539CourseDescription\u4e3b\u952e\u751f\u6210\u7b56\u7565"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'@ApiModelProperty(value = "\u8bfe\u7a0bID")\n@TableId(value = "id", type = IdType.INPUT)\nprivate String id;\n'})}),"\n",(0,i.jsx)(n.h2,{id:"3\u5b9a\u4e49\u5e38\u91cf",children:"3\u3001\u5b9a\u4e49\u5e38\u91cf"}),"\n",(0,i.jsx)(n.p,{children:"\u5b9e\u4f53\u7c7bCourse.Java\u4e2d\u5b9a\u4e49"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'public static final String COURSE_DRAFT = "Draft";\npublic static final String COURSE_NORMAL = "Normal";\n'})}),"\n",(0,i.jsx)(n.h2,{id:"4\u5b9a\u4e49\u63a7\u5236\u5c42\u63a5\u53e3",children:"4\u3001\u5b9a\u4e49\u63a7\u5236\u5c42\u63a5\u53e3"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'CourseAdminController.java\npackage com.guli.edu.controller.admin;\n\n@Api(description="\u8bfe\u7a0b\u7ba1\u7406")\n@CrossOrigin //\u8de8\u57df\n@RestController\n@RequestMapping("/admin/edu/course")\npublic class CourseAdminController {\n\n    @Autowired\n    private CourseService courseService;\n\n    @ApiOperation(value = "\u65b0\u589e\u8bfe\u7a0b")\n    @PostMapping("save-course-info")\n    public R saveCourseInfo(\n            @ApiParam(name = "CourseInfoForm", value = "\u8bfe\u7a0b\u57fa\u672c\u4fe1\u606f", required = true)\n            @RequestBody CourseInfoForm courseInfoForm){\n\n        String courseId = courseService.saveCourseInfo(courseInfoForm);\n        if(!StringUtils.isEmpty(courseId)){\n            return R.ok().data("courseId", courseId);\n        }else{\n            return R.error().message("\u4fdd\u5b58\u5931\u8d25");\n        }\n    }\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"5\u5b9a\u4e49\u4e1a\u52a1\u5c42\u65b9\u6cd5",children:"5\u3001\u5b9a\u4e49\u4e1a\u52a1\u5c42\u65b9\u6cd5"}),"\n",(0,i.jsx)(n.p,{children:"\u63a5\u53e3\uff1aCourseService.java"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"/**\n     * \u4fdd\u5b58\u8bfe\u7a0b\u548c\u8bfe\u7a0b\u8be6\u60c5\u4fe1\u606f\n     * @param courseInfoForm\n     * @return \u65b0\u751f\u6210\u7684\u8bfe\u7a0bid\n     */\nString saveCourseInfo(CourseInfoForm courseInfoForm);\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u5b9e\u73b0\uff1aCourseServiceImpl.java"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'@Autowired\nprivate CourseDescriptionService courseDescriptionService;\n\n@Override\npublic String saveCourseInfo(CourseInfoForm courseInfoForm) {\n\n    //\u4fdd\u5b58\u8bfe\u7a0b\u57fa\u672c\u4fe1\u606f\n    Course course = new Course();\n    course.setStatus(Course.COURSE_DRAFT);\n    BeanUtils.copyProperties(courseInfoForm, course);\n    boolean resultCourseInfo = this.save(course);\n    if(!resultCourseInfo){\n        throw new GuliException(20001, "\u8bfe\u7a0b\u4fe1\u606f\u4fdd\u5b58\u5931\u8d25");\n    }\n\n    //\u4fdd\u5b58\u8bfe\u7a0b\u8be6\u60c5\u4fe1\u606f\n    CourseDescription courseDescription = new CourseDescription();\n    courseDescription.setDescription(courseInfoForm.getDescription());\n    courseDescription.setId(course.getId());\n    boolean resultDescription = courseDescriptionService.save(courseDescription);\n    if(!resultDescription){\n        throw new GuliException(20001, "\u8bfe\u7a0b\u8be6\u60c5\u4fe1\u606f\u4fdd\u5b58\u5931\u8d25");\n    }\n\n    return course.getId();\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"6swagger\u6d4b\u8bd5",children:"6\u3001Swagger\u6d4b\u8bd5"}),"\n",(0,i.jsx)(n.h1,{id:"\u4e8c\u524d\u7aef\u5b9e\u73b0",children:"\u4e8c\u3001\u524d\u7aef\u5b9e\u73b0"}),"\n",(0,i.jsx)(n.h2,{id:"1\u5b9a\u4e49api",children:"1\u3001\u5b9a\u4e49api"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"import request from '@/utils/request'\n\nconst api_name = '/admin/edu/course'\n\nexport default {\n  saveCourseInfo(courseInfo) {\n    return request({\n      url: `${api_name}/save-course-info`,\n      method: 'post',\n      data: courseInfo\n    })\n  }\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"2\u7ec4\u4ef6\u6a21\u677f",children:"2\u3001\u7ec4\u4ef6\u6a21\u677f"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'<el-form label-width="120px">\n\n  <el-form-item label="\u8bfe\u7a0b\u6807\u9898">\n    <el-input v-model="courseInfo.title" placeholder=" \u793a\u4f8b\uff1a\u673a\u5668\u5b66\u4e60\u9879\u76ee\u8bfe\uff1a\u4ece\u57fa\u7840\u5230\u642d\u5efa\u9879\u76ee\u89c6\u9891\u8bfe\u7a0b\u3002\u4e13\u4e1a\u540d\u79f0\u6ce8\u610f\u5927\u5c0f\u5199"/>\n  </el-form-item>\n\n  \x3c!-- \u6240\u5c5e\u5206\u7c7b TODO --\x3e\n\n  \x3c!-- \u8bfe\u7a0b\u8bb2\u5e08 TODO --\x3e\n\n  <el-form-item label="\u603b\u8bfe\u65f6">\n    <el-input-number :min="0" v-model="courseInfo.lessonNum" controls-position="right" placeholder="\u8bf7\u586b\u5199\u8bfe\u7a0b\u7684\u603b\u8bfe\u65f6\u6570"/>\n  </el-form-item>\n\n  \x3c!-- \u8bfe\u7a0b\u7b80\u4ecb TODO --\x3e\n\n  \x3c!-- \u8bfe\u7a0b\u5c01\u9762 TODO --\x3e\n\n  <el-form-item label="\u8bfe\u7a0b\u4ef7\u683c">\n    <el-input-number :min="0" v-model="courseInfo.price" controls-position="right" placeholder="\u514d\u8d39\u8bfe\u7a0b\u8bf7\u8bbe\u7f6e\u4e3a0\u5143"/> \u5143\n  </el-form-item>\n\n  <el-form-item>\n    <el-button :disabled="saveBtnDisabled" type="primary" @click="next">\u4fdd\u5b58\u5e76\u4e0b\u4e00\u6b65</el-button>\n  </el-form-item>\n</el-form>\n'})}),"\n",(0,i.jsx)(n.h2,{id:"3\u7ec4\u4ef6js",children:"3\u3001\u7ec4\u4ef6js"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"<script>\nimport course from '@/api/edu/course'\n\nconst defaultForm = {\n  title: '',\n  subjectId: '',\n  teacherId: '',\n  lessonNum: 0,\n  description: '',\n  cover: '',\n  price: 0\n}\n\nexport default {\n  data() {\n    return {\n      courseInfo: defaultForm,\n      saveBtnDisabled: false // \u4fdd\u5b58\u6309\u94ae\u662f\u5426\u7981\u7528\n    }\n  },\n\n  watch: {\n    $route(to, from) {\n      console.log('watch $route')\n      this.init()\n    }\n  },\n\n  created() {\n    console.log('info created')\n    this.init()\n  },\n\n  methods: {\n\n    init() {\n      if (this.$route.params && this.$route.params.id) {\n        const id = this.$route.params.id\n        console.log(id)\n      } else {\n        this.courseInfo = { ...defaultForm }\n      }\n    },\n\n    next() {\n      console.log('next')\n      this.saveBtnDisabled = true\n      if (!this.courseInfo.id) {\n        this.saveData()\n      } else {\n        this.updateData()\n      }\n    },\n\n    // \u4fdd\u5b58\n    saveData() {\n      course.saveCourseInfo(this.courseInfo).then(response => {\n        this.$message({\n          type: 'success',\n          message: '\u4fdd\u5b58\u6210\u529f!'\n        })\n        return response// \u5c06\u54cd\u5e94\u7ed3\u679c\u4f20\u9012\u7ed9then\n      }).then(response => {\n        this.$router.push({ path: '/edu/course/chapter/' + response.data.courseId })\n      }).catch((response) => {\n        this.$message({\n          type: 'error',\n          message: response.message\n        })\n      })\n    },\n\n    updateData() {\n      this.$router.push({ path: '/edu/course/chapter/1' })\n    }\n  }\n}\n<\/script>\n"})})]})}function d(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(u,{...e})}):u(e)}}}]);