---
id: 05-ç»§æ‰¿å’Œå°è£…
title: 05-ç»§æ‰¿å’Œå°è£…
tags: [Python]
---

# ç»§æ‰¿

Python ä¸­çš„ç»§æ‰¿ï¼ˆInheritanceï¼‰æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆOOPï¼‰ä¸­æœ€é‡è¦çš„æ¦‚å¿µä¹‹ä¸€ï¼Œå®ƒå…è®¸ä¸€ä¸ªç±»ï¼ˆå­ç±»ï¼‰ä»å¦ä¸€ä¸ªç±»ï¼ˆçˆ¶ç±»ï¼‰ç»§æ‰¿å±æ€§å’Œæ–¹æ³•ï¼Œä»è€Œæé«˜ä»£ç çš„å¤ç”¨æ€§å’Œå¯æ‰©å±•æ€§ã€‚

## 1.ç»§æ‰¿çš„åŸºæœ¬è¯­æ³•

Python ä½¿ç”¨ `class å­ç±»(çˆ¶ç±»):` çš„æ–¹å¼å®ç°ç»§æ‰¿ã€‚

```python
class Animal:
    def __init__(self, name):
        self.name = name

    def speak(self):
        return "åŠ¨ç‰©åœ¨å«"


# å®šä¹‰å­ç±»ï¼ˆç»§æ‰¿è‡ª Animalï¼‰
class Dog(Animal):
    def speak(self):  # é‡å†™çˆ¶ç±»æ–¹æ³•
        return "æ±ªæ±ªæ±ª"


# åˆ›å»ºå¯¹è±¡
dog = Dog("æ—ºè´¢")
print(dog.name)  # ç»§æ‰¿äº† Animal çš„ name å±æ€§
print(dog.speak())  # è°ƒç”¨å­ç±»é‡å†™çš„æ–¹æ³•ï¼Œè¾“å‡ºï¼šæ±ªæ±ªæ±ª
```

ğŸ‘† è¯´æ˜ï¼š

- Dog ç»§æ‰¿äº† Animalï¼Œå› æ­¤ Dog å…·æœ‰ Animal çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ã€‚
- Dog é‡æ–°å®šä¹‰äº† speak() æ–¹æ³•ï¼Œ**è¦†ç›–**äº† Animal çš„ speak() æ–¹æ³•ï¼ˆæ–¹æ³•é‡å†™ï¼‰ã€‚

## 2.`super()`å…³é”®å­—ï¼šè°ƒç”¨çˆ¶ç±»æ–¹æ³•

å¦‚æœå­ç±»éœ€è¦ **åœ¨é‡å†™æ–¹æ³•çš„åŒæ—¶è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•**ï¼Œå¯ä»¥ä½¿ç”¨ `super()`ã€‚

```python
class Animal:
    def __init__(self, name):
        self.name = name

    def speak(self):
        return "åŠ¨ç‰©åœ¨å«"


class Cat(Animal):
    def __init__(self, name, color):
        super().__init__(name)  # è°ƒç”¨çˆ¶ç±»çš„ __init__
        self.color = color  # å­ç±»æ–°å¢å±æ€§

    def speak(self):
        return super().speak() + "ï¼Œä½†æˆ‘æ˜¯çŒ«ï¼Œæˆ‘ä¼šå–µå–µå«"


cat = Cat("å°èŠ±", "ç™½è‰²")
print(cat.name, cat.color)  # ç»§æ‰¿ nameï¼Œ æ–°å¢ color
print(cat.speak())  # å…ˆè°ƒç”¨çˆ¶ç±» speak()ï¼Œå†æ‰©å±•
```

ğŸ”¹ è¯´æ˜ï¼š

- `super().__init__(name)` è°ƒç”¨çˆ¶ç±»çš„æ„é€ æ–¹æ³•ï¼Œé¿å…é‡å¤ä»£ç ã€‚
- `super().speak()` è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•ï¼Œç„¶ååœ¨å­ç±»ä¸­æ‰©å±•ã€‚

## 3.å¤šçº§ç»§æ‰¿

Python å…è®¸ä¸€ä¸ªç±»ç»§æ‰¿å¦ä¸€ä¸ªå­ç±»ï¼Œå½¢æˆ **ç»§æ‰¿é“¾**ã€‚

```python
class Animal:
    def speak(self):
        return "åŠ¨ç‰©å‘å‡ºå£°éŸ³"


class Mammal(Animal):  # ç»§æ‰¿ Animal
    def has_fur(self):
        return "æˆ‘æ˜¯å“ºä¹³åŠ¨ç‰©ï¼Œæœ‰æ¯›å‘"


class Dog(Mammal):  # ç»§æ‰¿ Mammal
    def speak(self):
        return "æ±ªæ±ªæ±ª"


dog = Dog()
print(dog.speak())  # æ±ªæ±ªæ±ªï¼ˆç»§æ‰¿ Animal -> Mammal -> Dogï¼‰
print(dog.has_fur())  # æˆ‘æ˜¯å“ºä¹³åŠ¨ç‰©ï¼Œæœ‰æ¯›å‘
```

ğŸ”¹ è¯´æ˜ï¼š

- Dog ç»§æ‰¿äº† `Mammal`ï¼Œè€Œ `Mammal` ç»§æ‰¿äº† `Animal`ï¼Œæ‰€ä»¥ Dog æ—¢èƒ½è°ƒç”¨ `speak()`ï¼Œä¹Ÿèƒ½è°ƒç”¨ `has_fur()`ã€‚

## 4.å¤šé‡ç»§æ‰¿

Python **æ”¯æŒå¤šé‡ç»§æ‰¿**ï¼Œå³ä¸€ä¸ªå­ç±»å¯ä»¥ **åŒæ—¶ç»§æ‰¿å¤šä¸ªçˆ¶ç±»**ã€‚

```python
class Animal:
    def eat(self):
        return "æˆ‘ä¼šåƒä¸œè¥¿"


class Flyable:
    def fly(self):
        return "æˆ‘ä¼šé£"


class Bird(Animal, Flyable):  # åŒæ—¶ç»§æ‰¿ Animal å’Œ Flyable
    pass


bird = Bird()
print(bird.eat())  # ç»§æ‰¿è‡ª Animal
print(bird.fly())  # ç»§æ‰¿è‡ª Flyable
```

ğŸ”¹ è¯´æ˜ï¼š

- Bird ç»§æ‰¿äº† Animal å’Œ Flyableï¼Œå› æ­¤å¯ä»¥ **åŒæ—¶æ‹¥æœ‰** å®ƒä»¬çš„æ–¹æ³•ã€‚
- å¤šé‡ç»§æ‰¿ **å¯ä»¥è®©ç±»æ›´å¼ºå¤§**ï¼Œä½†ä¹Ÿå¯èƒ½å¯¼è‡´ **ä»£ç å¤æ‚æ€§å¢åŠ **ï¼Œéœ€è¦åˆç†ä½¿ç”¨ã€‚

## 5.`isinstance()`å’Œ`issubclass()`

Python æä¾›äº†ä¸¤ä¸ª**å†…ç½®å‡½æ•°**æ¥æ£€æŸ¥ç»§æ‰¿å…³ç³»ï¼š

- `isinstance(obj, Class)`ï¼šæ£€æŸ¥ `obj` æ˜¯å¦æ˜¯ `Class` æˆ–å…¶å­ç±»çš„å®ä¾‹ã€‚
- `issubclass(SubClass, ParentClass)`ï¼šæ£€æŸ¥ `SubClass` æ˜¯å¦æ˜¯ `ParentClass` çš„å­ç±»ã€‚

```python
class Animal: pass
class Dog(Animal): pass

dog = Dog()

print(isinstance(dog, Dog))     # True
print(isinstance(dog, Animal))  # True
print(issubclass(Dog, Animal))  # True
print(issubclass(Dog, object))  # Trueï¼ˆæ‰€æœ‰ç±»éƒ½ç»§æ‰¿è‡ª objectï¼‰
```

## 6.æ–¹æ³•è§£æé¡ºåºï¼ˆMROï¼‰

åœ¨å¤šé‡ç»§æ‰¿ä¸­ï¼ŒPython éœ€è¦ç¡®å®šè°ƒç”¨æ–¹æ³•æ—¶çš„é¡ºåºã€‚Python ä½¿ç”¨ **C3çº¿æ€§åŒ–ï¼ˆC3 Linearizationï¼‰**è§„åˆ™ï¼ŒæŸ¥æ‰¾é¡ºåºéµå¾ª `MROï¼ˆMethod Resolution Orderï¼‰`ã€‚

```python
class A:
    def show(self):
        print("A ç±»")

class B(A):
    def show(self):
        print("B ç±»")

class C(A):
    def show(self):
        print("C ç±»")

class D(B, C):  # å¤šé‡ç»§æ‰¿
    pass

d = D()
d.show()  # B ç±»

# æŸ¥çœ‹ MRO é¡ºåº
print(D.__mro__)  # è¾“å‡ºï¼š(<class '__main__.D'>, <class '__main__.B'>, <class '__main__.C'>, <class '__main__.A'>, <class 'object'>)
```

ğŸ”¹ MRO è§£æè§„åˆ™ï¼š

1. ä¼˜å…ˆæœç´¢å­ç±»ï¼ˆæœ€å·¦ä¼˜å…ˆï¼‰ï¼Œå³å…ˆæœç´¢ Bï¼Œå†æœç´¢ Cã€‚
2. å¦‚æœ B å’Œ C éƒ½æ²¡æœ‰è¯¥æ–¹æ³•ï¼Œåˆ™æœç´¢ Aã€‚
3. æœ€ç»ˆä¼šæœç´¢ `object`ï¼ˆPython 3 ä¸­æ‰€æœ‰ç±»é»˜è®¤ç»§æ‰¿ `object`ï¼‰ã€‚

## 7.æŠ½è±¡ç±»ï¼ˆAbstract Classï¼‰

æœ‰æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›æŸäº›ç±»ä¸èƒ½è¢«å®ä¾‹åŒ–ï¼Œåªèƒ½ä½œä¸ºåŸºç±»ï¼ˆçˆ¶ç±»ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ `abc` æ¨¡å—å®šä¹‰**æŠ½è±¡ç±»**ã€‚

```python
from abc import ABC, abstractmethod

class Animal(ABC):  # ç»§æ‰¿ ABCï¼Œä½¿å…¶å˜æˆæŠ½è±¡ç±»
    @abstractmethod
    def speak(self):  # æŠ½è±¡æ–¹æ³•ï¼Œå¿…é¡»åœ¨å­ç±»ä¸­å®ç°
        pass

class Dog(Animal):
    def speak(self):
        return "æ±ªæ±ªæ±ª"

# animal = Animal()  # âŒ æŠ½è±¡ç±»ä¸èƒ½è¢«å®ä¾‹åŒ–
dog = Dog()
print(dog.speak())  # âœ… å­ç±»å®ç°äº†æŠ½è±¡æ–¹æ³•ï¼Œå¯ä»¥å®ä¾‹åŒ–
```

**ğŸ”¹ è¯´æ˜ï¼š**

- `ABC` è®© `Animal` å˜æˆ**æŠ½è±¡ç±»**ï¼Œä¸èƒ½ç›´æ¥å®ä¾‹åŒ–ã€‚
- `@abstractmethod` è¡¨ç¤º**å¿…é¡»**åœ¨å­ç±»ä¸­å®ç° `speak()`ï¼Œå¦åˆ™å­ç±»ä¹Ÿä¸èƒ½å®ä¾‹åŒ–ã€‚

## æŸ¥çœ‹ç±»çš„è°ƒç”¨æ–¹æ³•çš„é¡ºåº

è°ƒç”¨ `ç±»å.__mro__` æ–¹æ³•ï¼Œå¯ä»¥æŸ¥çœ‹è¯¥ç±»çš„è°ƒç”¨æ–¹æ³•çš„é¡ºåºã€‚

## æ€»ç»“

| **ç»§æ‰¿ç±»å‹** | **æè¿°**                         |
| ------------ | -------------------------------- |
| **å•ç»§æ‰¿**   | å­ç±»ç»§æ‰¿ä¸€ä¸ªçˆ¶ç±»                 |
| **å¤šçº§ç»§æ‰¿** | å­ç±»ç»§æ‰¿å¦ä¸€ä¸ªå­ç±»               |
| **å¤šé‡ç»§æ‰¿** | å­ç±»ç»§æ‰¿å¤šä¸ªçˆ¶ç±»                 |
| **æ–¹æ³•é‡å†™** | å­ç±»é‡å†™çˆ¶ç±»æ–¹æ³•                 |
| `super()`    | è°ƒç”¨çˆ¶ç±»æ–¹æ³•                     |
| **MRO æœºåˆ¶** | ç¡®å®šæ–¹æ³•æŸ¥æ‰¾é¡ºåº                 |
| **æŠ½è±¡ç±»**   | å®šä¹‰æ¨¡æ¿ç±»ï¼Œå­ç±»å¿…é¡»å®ç°æŠ½è±¡æ–¹æ³• |

ç»§æ‰¿æé«˜äº†**ä»£ç å¤ç”¨**å’Œ**å¯æ‰©å±•æ€§**ï¼Œæ˜¯ Python OOP **æ ¸å¿ƒç‰¹æ€§**ä¹‹ä¸€ï¼ ğŸš€